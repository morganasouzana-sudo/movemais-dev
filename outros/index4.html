<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Canal de Inteligência de Mercado — Sebrae (Beta)</title>
  <meta name="description" content="Canal digital que reúne insights, análises e recomendações para apoiar a Rede Sebrae e os Pequenos Negócios. Conteúdo em versão beta.">
  <link rel="canonical" href="https://seu-site-exemplo.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0f3336;
      --muted:#bfcfce;
      --accent:#3f7a57;
      --accent-2:#2f5f46;
      --card-bg: rgba(255,255,255,0.04);
      --max-inner:1200px;
      --gutter:20px;
      --radius:12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;padding:0;background:var(--bg);color:#fff;font-family:'Unbounded',system-ui,Arial,sans-serif}
    a{color:inherit;text-decoration:none}
    .inner{max-width:var(--max-inner);margin:0 auto;padding:20px var(--gutter)}

    /* header */
    header{background:var(--bg);border-bottom:1px solid rgba(255,255,255,0.03);position:sticky;top:0;z-index:40}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;cursor:pointer}
    .brand img{height:30px}
    .menu{display:flex;gap:12px}
    .menu a{font-size:14px;padding:6px 8px;border-radius:8px;color:rgba(255,255,255,0.9)}

    /* hero grid */
    .hero { padding:36px 0 18px; border-bottom:1px solid rgba(255,255,255,0.04); }
    .hero-grid { display:grid; grid-template-columns: 1fr 640px; gap:30px; align-items:center; }

    .hero-panel {
      background: rgba(6,30,31,0.36);
      padding:28px; border-radius:14px;
      box-shadow:0 14px 40px rgba(0,0,0,0.45);
      border:1px solid rgba(255,255,255,0.03);
    }
    .hero-title { font-size:64px; margin:0 0 10px; line-height:0.98; font-weight:800; text-shadow: 0 12px 30px rgba(0,0,0,0.6) }
    .hero-lead { color:var(--muted); font-size:15px; max-width:760px; margin:0 0 18px; line-height:1.45; text-shadow:0 4px 14px rgba(0,0,0,0.35) }
    .hero-ctas{display:flex;gap:12px}
    .btn{background:linear-gradient(180deg,var(--accent),var(--accent-2));padding:10px 16px;border-radius:10px;color:#fff;font-weight:700;display:inline-block}

    /* image columns - larger */
    .image-columns { display:flex; gap:18px; justify-content:center; align-items:flex-start; overflow:hidden; }
    .col { width:360px; height:720px; overflow:hidden; border-radius:12px; position:relative;
          background: linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.06));
          border:1px solid rgba(255,255,255,0.03); }
    .stack { position:absolute; inset:0; display:flex; flex-direction:column; gap:18px; padding:16px; transform: translateY(0); will-change: transform; }
    .tile { height:400px; border-radius:10px; overflow:hidden; background:#111; box-shadow:0 10px 24px rgba(0,0,0,0.35); border:1px solid rgba(255,255,255,0.02); display:flex; position:relative; cursor:pointer; }
    .tile img { width:100%; height:100%; object-fit:cover; display:block; }

    /* fallback tile when image fails */
    .tile .fallback { width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#0c2b2d,#052223); color:var(--muted); font-size:15px; padding:10px; text-align:center; }

    /* overlay pill */
    .tile .pill { position:absolute; left:12px; top:10px; background:linear-gradient(180deg,var(--accent),var(--accent-2)); padding:8px 10px;border-radius:10px;font-size:13px;font-weight:800; box-shadow:0 6px 12px rgba(0,0,0,0.4); opacity:0; transform: translateY(-6px); transition:opacity .18s, transform .18s; pointer-events:none; }
    .tile:hover .pill, .tile:focus-within .pill, .tile.show-pill .pill { opacity:1; transform: translateY(0); pointer-events:auto; }

    /* seamless continuous scroll */
    @keyframes scrollDown { 0%{ transform: translateY(0); } 100%{ transform: translateY(-50%); } }
    .stack.animated { animation: scrollDown linear infinite; animation-duration: 30s; }
    .col.col-1 .stack.animated { animation-duration: 32s; }
    .col.col-2 .stack.animated { animation-duration: 36s; }

    /* controls / filters */
    .controls { display:flex; gap:10px; align-items:center; margin-top:18px; flex-wrap:wrap; }
    .search { flex:1; min-width:200px; }
    .search input { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:rgba(255,255,255,0.02); color:#fff; }
    .chips { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .chip { padding:6px 12px; border-radius:999px; background:rgba(255,255,255,0.03); cursor:pointer; color:var(--muted); font-weight:700; font-size:13px; }
    .chip.active { background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#fff; }

    /* insights grid */
    .insights-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:12px; }
    .insight-card { background:var(--card-bg); padding:12px; border-radius:12px; min-height:120px; display:flex; flex-direction:column; gap:8px; position:relative; }
    .tags-row { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .tag-small { background:rgba(255,255,255,0.03); padding:6px 8px; border-radius:8px; color:var(--muted); font-weight:700; font-size:12px; }

    .sources { margin-top:18px; color:var(--muted); font-size:13px }

    /* contact card tweaks */
    .contact-card { background:var(--card-bg); padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.02); display:flex; flex-direction:column; gap:12px; }
    .contact-card .btn { width:fit-content; padding:10px 14px; font-size:15px; }

    /* SEBRAE central tile (novo) */
    .sebrae-center { display:flex; justify-content:center; margin-bottom:12px; }
    .sebrae-center img { height:64px; width:auto; display:block; filter: drop-shadow(0 8px 18px rgba(0,0,0,0.6)); }

    /* PONTO CERTO preview card (novo) */
    .opontocerto-card { display:grid; grid-template-columns: 1fr 360px; gap:16px; align-items:center; background:var(--card-bg); padding:16px; border-radius:12px; border:1px solid rgba(255,255,255,0.02); margin-top:18px; }
    .opc-info h3{margin:0 0 8px 0;color:var(--text)}
    .opc-info p{margin:0 0 12px;color:var(--muted)}
    .opc-preview { display:flex; flex-direction:column; gap:8px; align-items:stretch; }
    .opc-preview .preview-box { height:220px; border-radius:10px; overflow:hidden; background:#061515; border:1px solid rgba(255,255,255,0.03); display:flex; align-items:center; justify-content:center; position:relative; }
    .opc-preview .preview-box img { width:100%; height:100%; object-fit:cover; display:block; }
    .opc-preview .preview-controls { display:flex; gap:8px; justify-content:space-between; align-items:center; }
    .opc-note { font-size:13px; color:var(--muted); }

    /* responsive */
    @media (max-width:1100px) { .hero-grid { grid-template-columns:1fr 520px; gap:20px } .col{height:640px;width:300px} .hero-title{font-size:48px} .insights-grid{grid-template-columns:repeat(2,1fr)} .tile{height:210px} .opontocerto-card{grid-template-columns:1fr 300px} }
    @media (max-width:820px) { .hero-grid{grid-template-columns:1fr} .image-columns{order:2;margin-top:18px;justify-content:flex-start} .col{width:48%;height:520px} .hero-panel{padding:20px} .hero-title{font-size:36px} .insights-grid{grid-template-columns:1fr} .tile{height:180px} .opontocerto-card{grid-template-columns:1fr} .opc-preview{order:-1} }
    @media (max-width:480px) { .col{width:100%;height:300px} .image-columns{flex-direction:column;gap:12px} .stack{padding:10px} .hero-title{font-size:28px} .tile{height:140px} }
    /* container principal do header */
.nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;

  /* reserva espaço para não esmagar o centro */
  padding-left: 60px;
  padding-right: 60px;
}

/* texto Mercados. alinhado à esquerda */
.page-title-header {
  font-weight: 800;
  font-size: 20px;
  color: var(--text);
  white-space: nowrap;
}

/* logo centralizada absolutamente */
.brand {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
}

.brand img {
  height: 46px; /* ajuste como preferir */
}

/* menu à direita */
.menu {
  display: flex;
  gap: 16px;
}

.menu a {
  font-size: 14px;
  padding: 6px 8px;
  border-radius: 8px;
  color: rgba(255,255,255,0.9);
}

  </style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="inner">
    <div class="nav">

      <!-- ESQUERDA: texto Mercados. -->
      <div class="page-title-header">
        Mercados.
      </div>

      <!-- CENTRO: logo do Sebrae -->
      <div class="brand">
        <img src="./assets/sebrae_fundo_transparente.webp" alt="Sebrae">
      </div>

      <!-- DIREITA: navegação -->
      <nav class="menu" aria-label="Navegação principal">
        <a href="#sobre">Sobre</a>
        <a href="#todos-insights">Insights</a>
        <a href="#contato">Contato</a>
      </nav>

    </div>
  </div>
</header>


  <!-- HERO -->
  <section class="hero" aria-label="hero">
    <div class="inner hero-grid">

      <!-- LEFT: content -->
      <div>
        <div class="hero-panel" role="region" aria-label="Resumo">
          <h1 class="hero-title">Inteligência de<br/>Mercado.</h1>
          <p class="hero-lead">Canal digital que reúne insights, análises e recomendações para apoiar a Rede e os pequenos negócios. Conteúdo em versão beta.</p>

          <div class="hero-ctas">
            <a class="btn" href="#todos-insights">Ver todos os insights</a>
            <a class="btn" href="https://opontocerto.sebrae.com.br/painel" style="background:transparent;border:1px solid rgba(255,255,255,0.06)">O Ponto Certo</a>
          </div>
        </div>

        <!-- Sobre -->
        <div style="margin-top:14px;">
          <div style="background:var(--card-bg);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)">
            <strong>Sobre o Canal</strong>
            <p class="muted" style="margin-top:8px">O Canal de Inteligência de Mercado é um hub de insights, análises e recomendações rápidas para apoiar a rede Sebrae e os pequenos negócios. Publicamos boletins, estudos e alertas por segmento.</p>
          </div>
        </div>

        <p class="sources" style="margin-top:12px">Fontes: Abrasel; Ecommerce Brasil; ABRAS; Agência Sebrae.</p>
      </div>

      <!-- RIGHT: two columns of images using your uploaded assets -->
      <div>
        <!-- Sebrae central (novo) -->
        <div class="image-columns" aria-hidden="false">
          <div class="col col-1" role="group" aria-label="Galeria 1">
            <div class="stack animated" aria-hidden="true">
              <div class="tile" data-tag="Conveniência" tabindex="0">
                <img src="./assets/hero-minimercado.webp" alt="Minimercado - prateleiras" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Conveniência</div>
              </div>
              <div class="tile" data-tag="Feira" tabindex="0">
                <img src="./assets/feira_livre.webp" alt="Feira livre" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Feira</div>
              </div>
              <div class="tile" data-tag="Frutas" tabindex="0">
                <img src="./assets/frutas_feira.webp" alt="Frutas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Frutas</div>
              </div>
              <!-- duplicated -->
              <div class="tile" data-tag="Conveniência" tabindex="0">
                <img src="./assets/hero-minimercado.webp" alt="Minimercado - prateleiras" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Conveniência</div>
              </div>
              <div class="tile" data-tag="Feira" tabindex="0">
                <img src="./assets/feira_livre.webp" alt="Feira livre" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Feira</div>
              </div>
              <div class="tile" data-tag="Frutas" tabindex="0">
                <img src="./assets/frutas_feira.webp" alt="Frutas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Frutas</div>
              </div>
            </div>
          </div>

          <div class="col col-2" role="group" aria-label="Galeria 2">
            <div class="stack animated" aria-hidden="true">
              <div class="tile" data-tag="Varejo" tabindex="0">
                <img src="./assets/loja_roupas_feira.webp" alt="Loja de roupas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Varejo</div>
              </div>
              <div class="tile" data-tag="Cabides" tabindex="0">
                <img src="./assets/cabide_roupas_masculinas.webp" alt="Cabide roupas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Cabide</div>
              </div>
              <div class="tile" data-tag="Cafeteria" tabindex="0">
                <img src="./assets/mulher_sentada_cafeteria.webp" alt="Pessoa em cafeteria" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Cafeteria</div>
              </div>
              <!-- duplicated -->
              <div class="tile" data-tag="Varejo" tabindex="0">
                <img src="./assets/loja_roupas_feira.webp" alt="Loja de roupas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Varejo</div>
              </div>
              <div class="tile" data-tag="Cabides" tabindex="0">
                <img src="./assets/cabide_roupas_masculinas.webp" alt="Cabide roupas" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Cabide</div>
              </div>
              <div class="tile" data-tag="Cafeteria" tabindex="0">
                <img src="./assets/mulher_sentada_cafeteria.webp" alt="Pessoa em cafeteria" loading="lazy" decoding="async" width="1200" height="800" onerror="handleImgError(this)">
                <div class="pill" style="display:none">Cafeteria</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- CONTROLS -->
  <section style="padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.02)">
    <div class="inner">
      <div class="controls" role="toolbar" aria-label="Filtros">
        <div class="search"><input id="searchInput" placeholder="Buscar insights (ex.: delivery, sazonalidade, omnichannel)" aria-label="Buscar insights"></div>
        <div class="chips" role="tablist" aria-label="Filtrar por segmento">
          <div class="chip active" data-filter="all">Todos</div>
          <div class="chip" data-filter="bares">Bares & Restaurantes</div>
          <div class="chip" data-filter="moda">Varejo de Moda</div>
          <div class="chip" data-filter="mini">Minimercados</div>
        </div>
      </div>
    </div>
  </section>

  <!-- DESTAQUE: O PONTO CERTO (nova seção) -->
  <section id="opontocerto" class="inner" aria-labelledby="opc-title" style="padding-top:18px">
    <div class="opontocerto-card" role="region" aria-label="Destaque O Ponto Certo">
      <div class="opc-info">
        <h3 id="opc-title">Destaque — O Ponto Certo</h3>
        <p>Visualize o painel do O Ponto Certo rapidamente. Se o preview estiver bloqueado por políticas do site, clique em "Abrir painel" para acessar em nova aba.</p>
        <p class="opc-note" style="margin-top:10px">Sugestão: usar o preview para treinamentos rápidos e o link para acessar o painel com credenciais completas.</p>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="opc-toggle" class="btn" aria-pressed="false">Abrir preview</button>
          <a class="btn" href="https://opontocerto.sebrae.com.br/painel" target="_blank" rel="noopener" style="background:transparent;border:1px solid rgba(255,255,255,0.06)">Abrir painel</a>
        </div>
      </div>

      <div class="opc-preview" aria-hidden="false">
        <div class="preview-box" id="opcPreviewBox" aria-live="polite" role="region" aria-label="Preview do O Ponto Certo">
          <!-- inicialmente mostra imagem fallback; JS tenta carregar iframe -->
          <img id="opcFallbackImg" src="./assets/opontocerto_preview.webp" alt="Preview O Ponto Certo" loading="lazy" width="360" height="220" onerror="this.style.display='none'">
          <!-- iframe será injetado via JS se permitido -->
        </div>
        <div class="preview-controls">
          <div class="opc-note" id="opcStatus">Preview: imagem de amostra</div>
        </div>
      </div>

    </div>
  </section>

  <!-- INSIGHTS -->
  <section id="todos-insights" style="padding:14px 0">
    <div class="inner">
      <h2 style="margin:0 0 12px">Todos os Insights</h2>

      <div class="insights-grid" id="insightsGrid">
        <article class="insight-card" data-tags="sazonalidade delivery" data-seg="bares">
          <h3 style="margin:0 0 6px">Bares & Restaurantes — Dez/2025</h3>
          <p class="muted" style="margin:0">Confraternizações impulsionam faturamento; digital é decisivo para captar demanda.</p>
          <div class="tags-row">
            <div class="tag-small">Sazonalidade</div>
            <div class="tag-small">Delivery</div>
            <div class="tag-small">Digital</div>
          </div>
          <div style="margin-top:auto;display:flex;justify-content:space-between;align-items:center">
            <a class="btn" href="insights_bares_restaurantes.html" style="padding:8px 10px;font-size:13px">Abrir</a>
            <a href="https://abrasel.com.br/noticias/noticias/confraternizacoes-de-fim-de-ano-aquecem-movimento-em-bares-e-restaurantes/" target="_blank" rel="noopener" style="color:var(--muted);font-size:13px">Fonte</a>
          </div>
        </article>

        <article class="insight-card" data-tags="omnichannel redes social" data-seg="moda">
          <h3 style="margin:0 0 6px">Varejo de Moda — Dez/2025</h3>
          <p class="muted" style="margin:0">Omnichannel e redes sociais aceleram conversão.</p>
          <div class="tags-row">
            <div class="tag-small">Omnichannel</div>
            <div class="tag-small">Redes</div>
          </div>
          <div style="margin-top:auto;display:flex;justify-content:space-between;align-items:center">
            <a class="btn" href="insights_varejo_moda.html" style="padding:8px 10px;font-size:13px">Abrir</a>
            <a href="https://ecommercebrasil.com.br" target="_blank" rel="noopener" style="color:var(--muted);font-size:13px">Fonte</a>
          </div>
        </article>

        <article class="insight-card" data-tags="conveniência proximidade apps" data-seg="mini">
          <h3 style="margin:0 0 6px">Minimercados — Dez/2025</h3>
          <p class="muted" style="margin:0">Proximidade e apps locais ampliam alcance; giro rápido é chave.</p>
          <div class="tags-row">
            <div class="tag-small">Conveniência</div>
            <div class="tag-small">Apps</div>
          </div>
          <div style="margin-top:auto;display:flex;justify-content:space-between;align-items:center">
            <a class="btn" href="insights_minimercados.html" style="padding:8px 10px;font-size:13px">Abrir</a>
            <a href="https://abras.com.br" target="_blank" rel="noopener" style="color:var(--muted);font-size:13px">Fonte</a>
          </div>
        </article>

      </div>

    </div>
  </section>

  <!-- footer / contato -->
  <section id="contato" style="padding:12px 0">
    <div class="inner">
      <div style="display:grid;grid-template-columns:1fr 320px;gap:12px;align-items:start">
        <div class="contact-card">
          <h3 style="margin:0 0 4px">Contato</h3>
          <p style="margin:0;color:var(--muted)">Envie comentários e sugestões sobre o canal.</p>
          <a class="btn" href="mailto:seu-email@exemplo.com" aria-label="Enviar mensagem por email">Enviar mensagem</a>
        </div>

        <div style="font-size:13px;color:var(--muted);padding:12px;background:var(--card-bg);border-radius:12px;border:1px solid rgba(255,255,255,0.02)">
          <strong>Atualmente publicados</strong>
          <p style="margin:6px 0 0">Bares & Restaurantes; Varejo de Moda; Minimercados.</p>
        </div>
      </div>
    </div>
  </section>

  <footer style="border-top:1px solid rgba(255,255,255,0.03);margin-top:18px">
    <div class="inner" style="padding:18px 20px;color:var(--muted);font-size:13px">© Canal de Inteligência de Mercado — Sebrae • Versão Beta</div>
  </footer>

<script>
  /* Helper: when an <img> fails, replace its tile content with fallback */
  function handleImgError(img){
    try{
      const tile = img.closest('.tile');
      if(!tile) return;
      if(tile.dataset.fallback === 'true') return;
      tile.dataset.fallback = 'true';
      if(img.parentNode) img.remove();
      const fallback = document.createElement('div');
      fallback.className = 'fallback';
      fallback.textContent = 'Imagem indisponível';
      tile.appendChild(fallback);
      const pill = tile.querySelector('.pill');
      if(pill) { pill.style.display = 'block'; tile.classList.add('show-pill'); }
    }catch(e){ console.warn('img fallback error', e); }
  }

  // respect reduced-motion
  (function(){
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if(prefersReduced){
      document.querySelectorAll('.stack.animated').forEach(s => s.style.animationPlayState = 'paused');
    }
  })();

  // Pause on touch for mobile only (allow interaction)
  (function(){
    const cols = document.querySelectorAll('.col');
    cols.forEach(col=>{
      col.addEventListener('touchstart', () => {
        const s = col.querySelector('.stack');
        if(s) s.style.animationPlayState = 'paused';
      }, {passive:true});
      col.addEventListener('touchend', () => {
        const s = col.querySelector('.stack');
        if(s) s.style.animationPlayState = 'running';
      }, {passive:true});
    });
  })();

  // Search + filter logic
  (function(){
    const searchInput = document.getElementById('searchInput');
    const chips = Array.from(document.querySelectorAll('.chip'));
    const cards = Array.from(document.querySelectorAll('.insight-card'));

    function applyFilter(){
      const q = (searchInput.value || '').trim().toLowerCase();
      const active = chips.find(c=>c.classList.contains('active'));
      const seg = active ? active.dataset.filter : 'all';

      cards.forEach(card=>{
        const text = (card.innerText || '').toLowerCase();
        const tags = (card.dataset.tags || '').toLowerCase();
        const segCard = card.dataset.seg || 'all';
        const matchesQ = q === '' || text.includes(q) || tags.includes(q);
        const matchesSeg = seg === 'all' || segCard === seg;
        card.style.display = (matchesQ && matchesSeg) ? 'flex' : 'none';
      });
    }

    chips.forEach(chip => chip.addEventListener('click', ()=>{
      chips.forEach(c=>c.classList.remove('active'));
      chip.classList.add('active');
      applyFilter();
    }));

    if(searchInput) searchInput.addEventListener('input', applyFilter);
    applyFilter();
  })();

  // Make tiles clickable to filter by tag (and keyboard accessible via Enter/Space)
  (function(){
    document.querySelectorAll('.tile').forEach(tile=>{
      tile.tabIndex = 0;
      tile.addEventListener('click', ()=>{
        const tag = (tile.dataset.tag || '').toLowerCase();
        if(!tag) return;
        const searchInput = document.getElementById('searchInput');
        if(searchInput){
          searchInput.value = tag;
          searchInput.dispatchEvent(new Event('input', {bubbles:true}));
          document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active'));
          const allChip = document.querySelector('.chip[data-filter="all"]');
          if(allChip) allChip.classList.add('active');
        }
      });
      tile.addEventListener('keydown', (ev)=>{
        if(ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); tile.click(); }
      });
    });
  })();

  /* --------------- O PONTO CERTO preview logic --------------- */
  (function(){
    const btn = document.getElementById('opc-toggle');
    const previewBox = document.getElementById('opcPreviewBox');
    const fallbackImg = document.getElementById('opcFallbackImg');
    const status = document.getElementById('opcStatus');
    const PANEL_URL = 'https://opontocerto.sebrae.com.br/painel';

    let iframe = null;
    let iframeLoaded = false;
    let iframeAttempted = false;

    function showStatus(text){ if(status) status.textContent = text; }

    async function tryInsertIframe(){
      if(iframeAttempted) return;
      iframeAttempted = true;
      showStatus('Tentando carregar preview...');
      // create iframe but don't assume it will show content (may be blocked)
      iframe = document.createElement('iframe');
      iframe.src = PANEL_URL;
      iframe.style.width = '100%';
      iframe.style.height = '100%';
      iframe.style.border = '0';
      iframe.title = 'Preview do O Ponto Certo';
      iframe.loading = 'lazy';

      // Listen for load and use timeout to detect likely block
      let loaded = false;
      const onLoad = ()=>{ loaded = true; iframeLoaded = true; showStatus('Preview carregado — interativo'); };
      const onError = ()=>{ loaded = false; showStatus('Preview indisponível (bloqueado) — abra em nova aba'); };

      iframe.addEventListener('load', onLoad);
      iframe.addEventListener('error', onError);

      // insert iframe (hidden initially)
      previewBox.appendChild(iframe);
      // after short delay, check if loaded; if not, assume blocked and remove iframe
      setTimeout(()=>{
        // If load event fired, keep iframe. Otherwise remove and show fallback.
        if(!loaded){
          // remove iframe as it's probably blocked by X-Frame-Options
          try{ iframe.remove(); }catch(e){}
          iframe = null;
          showStatus('Preview bloqueado por políticas do site — use "Abrir painel"');
        }
      }, 1600);
    }

    // toggle button
    btn.addEventListener('click', async function(){
      const pressed = this.getAttribute('aria-pressed') === 'true';
      if(!pressed){
        // open preview: attempt iframe; hide fallback image if iframe loads
        this.setAttribute('aria-pressed','true');
        this.textContent = 'Fechar preview';
        showStatus('Tentando abrir preview...');
        // attempt to insert iframe
        tryInsertIframe();
      } else {
        // close preview: remove iframe if present, show fallback image
        this.setAttribute('aria-pressed','false');
        this.textContent = 'Abrir preview';
        if(iframe){
          try{ iframe.remove(); }catch(e){}
          iframe = null;
        }
        showStatus('Preview: imagem de amostra');
      }
    });

    // also add link fallback note (in case iframe blocked)
    // note: user can always open panel in new tab via provided link
  })();
</script>

</body>
</html>
